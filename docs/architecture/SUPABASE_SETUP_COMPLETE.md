# Supabaseセットアップ完了チェックリスト

## ✅ 完了したステップ

- [x] Supabaseプロジェクトの作成
- [x] プロジェクトURLの取得: `https://uxuevczwmirlipcbptsx.supabase.co`
- [x] APIキーの取得（anon public key）
- [x] 環境変数の設定（`.env.local`）
- [x] データベーススキーマの作成
- [x] Realtimeの有効化
- [x] Row Level Security (RLS) の設定

## 🔄 次のステップ

### ステップ1: アプリケーションの再起動

**重要**: `.env.local`ファイルを作成・変更した場合は、**必ずアプリケーションを再起動**してください。

```bash
# 現在のアプリケーションを停止（Ctrl+C）
# 再度起動
npm run tauri:dev
```

### ステップ2: 設定の検証

アプリケーション内で`/supabase-config-check`にアクセスして確認：

- [ ] データソースが「✅ Supabase」と表示される
- [ ] Supabase URLが正しく表示される
- [ ] APIキーが「✅ 設定済み」と表示される
- [ ] 接続状態が「✅ 接続成功」と表示される
- [ ] エラーや警告が表示されない
- [ ] 「✅ 設定は正常です」と表示される

### ステップ3: 動作確認

1. **動作確認ページでの確認**
   - `/supabase-test`にアクセス
   - ページが正常に表示される
   - データソース情報が表示される

2. **リアルタイム同期の確認**（オプション）
   - 複数のTauriアプリケーションウィンドウを開く
   - 一方で組織を追加・更新すると、他方にリアルタイムで反映されることを確認

## トラブルシューティング

### データソースが「ローカルSQLite」のままの場合

1. `.env.local`ファイルが正しく作成されているか確認
   ```bash
   cat .env.local
   ```

2. アプリケーションが完全に再起動されたか確認
   - ターミナルで`Ctrl + C`で停止
   - 再度`npm run tauri:dev`で起動

3. 環境変数が正しく読み込まれているか確認
   - 開発者ツールのコンソールで確認
   - `process.env.NEXT_PUBLIC_USE_SUPABASE`の値を確認

### 接続エラーが発生する場合

1. Supabase URLとAPIキーが正しいか確認
2. ネットワーク接続を確認
3. Supabaseプロジェクトが正常に動作しているか確認（ダッシュボードで確認）
4. RLSポリシーが正しく設定されているか確認

### Realtimeが動作しない場合

1. Realtimeスクリプトが正しく実行されたか確認
2. テーブルでRealtimeが有効化されているか確認（Database → Replication）
3. ブラウザのコンソールでエラーを確認

## 次のステップ

すべての確認が完了したら：

1. **既存機能の統合**
   - `useOrganizationDataWithRealtime`を使用してリアルタイム同期を有効化
   - 詳細は[統合ガイド: INTEGRATION_GUIDE.md](./INTEGRATION_GUIDE.md)を参照

2. **データ移行**（オプション）
   - 既存のSQLiteデータをSupabaseに移行
   - データ移行スクリプトを作成（将来実装予定）

3. **本番環境への移行準備**
   - パフォーマンステスト
   - セキュリティ設定の確認

