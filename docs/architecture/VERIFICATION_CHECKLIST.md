# 動作確認チェックリスト

このドキュメントでは、Supabase移行と共同編集機能の動作確認項目をリストアップします。

## ローカルSQLiteモードでの確認

### ✅ 基本動作確認

- [ ] 開発サーバーが正常に起動する
- [ ] メインページ（`http://localhost:3020`）が表示される
- [ ] 組織管理ページ（`http://localhost:3020/organization`）が表示される
- [ ] 設定検証ページ（`http://localhost:3020/supabase-config-check`）が表示される
- [ ] 設定検証ページで「ローカルSQLite」と表示される

### ✅ データ操作の確認

- [ ] 組織の一覧が表示される
- [ ] 組織の詳細が表示される
- [ ] 組織の作成ができる
- [ ] 組織の更新ができる
- [ ] 組織の削除ができる

### ✅ 既存機能の確認

- [ ] 既存のAPI呼び出しが正常に動作する
- [ ] エラーハンドリングが正常に動作する
- [ ] データの整合性が保たれている

## Supabaseモードでの確認

### ✅ 設定の確認

- [ ] `.env.local`ファイルに環境変数が設定されている
- [ ] 設定検証ページで「Supabase」と表示される
- [ ] 設定検証ページで「✅ 接続成功」と表示される
- [ ] エラーや警告が表示されない

### ✅ データベーススキーマの確認

- [ ] Supabaseダッシュボードでテーブルが作成されている
- [ ] 主要なテーブル（organizations, entities, relations, topics）が存在する
- [ ] インデックスが作成されている
- [ ] 外部キー制約が設定されている

### ✅ Realtimeの確認

- [ ] Realtimeが有効化されている
- [ ] 複数のブラウザタブで同じページを開ける
- [ ] 一方でデータを更新すると、他方にリアルタイムで反映される
- [ ] ブラウザのコンソールにエラーが表示されない

### ✅ リアルタイム同期の確認

1. **動作確認ページでの確認**
   - [ ] `http://localhost:3020/supabase-test`にアクセス
   - [ ] 複数のブラウザタブで同じページを開く
   - [ ] 一方で組織を追加すると、他方に表示される
   - [ ] 一方で組織を更新すると、他方に反映される
   - [ ] 一方で組織を削除すると、他方から消える

2. **既存ページでの確認**
   - [ ] 組織管理ページでリアルタイム同期が動作する
   - [ ] データの更新が即座に反映される

### ✅ 共同編集機能の確認

- [ ] 複数のブラウザで同じ組織を編集できる
- [ ] 競合が発生した場合、エラーメッセージが表示される
- [ ] 最新のデータを取得して再試行できる
- [ ] バージョン管理が正常に動作する

### ✅ オフライン対応の確認（オプション）

- [ ] オフライン時にキャッシュからデータを取得できる
- [ ] オフライン時の書き込みがキューに追加される
- [ ] オンライン復帰時に保留中の書き込みが同期される

### ✅ エラーハンドリングの確認

- [ ] ネットワークエラーが適切に処理される
- [ ] エラーメッセージがユーザーフレンドリーに表示される
- [ ] ログに適切な情報が記録される

## パフォーマンス確認

### ✅ レスポンス時間

- [ ] データ取得のレスポンス時間が許容範囲内
- [ ] リアルタイム同期の遅延が許容範囲内
- [ ] UIの応答性が良好

### ✅ リソース使用量

- [ ] メモリ使用量が適切
- [ ] CPU使用量が適切
- [ ] ネットワークトラフィックが適切

## セキュリティ確認

### ✅ 認証・認可

- [ ] 認証が必要な操作が適切に保護されている
- [ ] RLSポリシーが正しく設定されている
- [ ] 不正なアクセスが防止されている

### ✅ データ保護

- [ ] 機密情報が適切に保護されている
- [ ] APIキーが適切に管理されている
- [ ] エラーメッセージに機密情報が含まれていない

## チェックリストの使い方

1. 各項目を順番に確認
2. チェックボックスにチェックを入れる
3. 問題が発生した場合は、トラブルシューティングセクションを参照
4. すべての項目が完了したら、本番環境への移行を検討

## トラブルシューティング

### 開発サーバーが起動しない

- ポート3020が使用中でないか確認
- 他のプロセスを終了してから再試行
- `npm run dev`を再実行

### 設定検証ページでエラーが表示される

- `.env.local`ファイルの内容を確認
- 環境変数が正しく設定されているか確認
- Supabaseプロジェクトが正常に動作しているか確認

### リアルタイム同期が動作しない

- SupabaseプロジェクトでRealtimeが有効になっているか確認
- テーブルでRealtimeが有効化されているか確認
- ブラウザのコンソールでエラーを確認
- ネットワーク接続を確認

### データが表示されない

- データベーススキーマが正しく作成されているか確認
- データが実際に存在するか確認
- RLSポリシーがデータアクセスを許可しているか確認

## 参考資料

- [クイックスタート: QUICK_START.md](./QUICK_START.md)
- [開発環境セットアップ: DEVELOPMENT_SETUP.md](./DEVELOPMENT_SETUP.md)
- [統合ガイド: INTEGRATION_GUIDE.md](./INTEGRATION_GUIDE.md)

